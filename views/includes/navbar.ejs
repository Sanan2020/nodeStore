<!DOCTYPE html>
<html lang="en">

<head>
    <!-- FontAwesome Icons CDN -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="icon" type="image/png" sizes="16x16" href="/img/icon.png" />

    <!-- Bootstrap 5 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="/js/cart.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="UTF-8">
    <link rel="stylesheet" href="/css/navbar.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="/css/profile.css">
    <title>Croissant</title>

    <!-- Navbar (App Bar) -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="/" style="font-size: 24px;">MAMON</a>

            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="/">Home</a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" href="#" id="cartIcon"><i class="fas fa-shopping-cart">
                                <div id="count" class="lb">0</div>
                            </i>
                        </a>
                    </li>

                    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
                    <script>
                        document.getElementById("cartIcon").addEventListener("click", function (event) {
                            event.preventDefault(); // ป้องกันการเปลี่ยนหน้า

                            let logIn = "<%= loggedIn %>"
                            if (!logIn) {
                                Swal.fire({
                                    title: "คุณยังไม่ได้ล็อกอิน",
                                    text: "กรุณาเข้าสู่ระบบเพื่อดูสินค้าในตะกร้า",
                                    icon: "warning",
                                    showCancelButton: true,
                                    confirmButtonText: "ล็อกอิน",
                                    cancelButtonText: "ยกเลิก",
                                }).then((result) => {
                                    if (result.isConfirmed) {
                                        window.location.href = "/login";
                                    }
                                });
                            } else {
                                window.location.href = "/cart";
                            }

                        });
                    </script>

                    <% if(loggedIn){ %>
                    <!-- <li class="nav-item">
                        <a class="nav-link" href="/logout">Logout</a>
                    </li> -->

                    <div class="profile-container">
                        <img src="/imgProfile/user.png" class="profile-icon" id="profileBtn" />
                        <div class="dropdown-menu" id="dropdownMenu">
                            <p style="font-size: 16px; text-align: center;">Customer ID<br /><span
                                    style="font-size: 12px; color: rgb(168, 168, 168);"><%= loggedIn %></span></p>
                            <hr>
                            <!-- <a href="#">Profile</a>
                            <a href="#">Settings</a> -->
                            <a href="/logout">Logout</a>
                        </div>
                    </div>

                    <% } %>

                    <% if(!loggedIn){ %>
                    <li class="nav-item">
                        <a class="nav-link" href="/login">Login</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/adminLogin"><span style="opacity: 0.5;">|</span> Admin Login <span
                                style="opacity: 0.5;">|</span></a>
                    </li>
                    <% } %>

                </ul>
            </div>
        </div>
    </nav>

    <script>
        const profileBtn = document.getElementById("profileBtn");
        const dropdownMenu = document.getElementById("dropdownMenu");

        profileBtn.addEventListener("click", () => {
            dropdownMenu.style.display = dropdownMenu.style.display === "block" ? "none" :
                "block";
        });

        document.addEventListener("click", (event) => {
            if (!profileBtn.contains(event.target) && !dropdownMenu.contains(event.target)) {
                dropdownMenu.style.display = "none";
            }
        });
    </script>